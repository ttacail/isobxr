<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3 - Run_isobxr: presentation • isobxr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3 - Run_isobxr: presentation">
<meta property="og:description" content="isobxr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isobxr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Demo_ABCD.html">Getting started 1: single runs /deprecated/</a>
    </li>
    <li>
      <a href="../articles/Demo_ABCD_composite.html">Getting started 2: composite runs</a>
    </li>
    <li>
      <a href="../articles/isobxr_vignette.html">Using isobxr</a>
    </li>
    <li>
      <a href="../articles/vgn_01_Installation.html">1 - Install isobxr</a>
    </li>
    <li>
      <a href="../articles/vgn_02_General_presentation.html">2 - General presentation</a>
    </li>
    <li>
      <a href="../articles/vgn_03_Run_isobxr_presentation.html">3 - Run_isobxr: presentation</a>
    </li>
    <li>
      <a href="../articles/vgn_04_Run_isobxr_tutorial.html">4 - Run_isobxr: tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ttacail/isobxr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3 - Run_isobxr: presentation</h1>
                        <h4 class="author">Théo Tacail</h4>
            
            <h4 class="date">2021-04-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ttacail/isobxr/blob/master/vignettes/vgn_03_Run_isobxr_presentation.Rmd"><code>vignettes/vgn_03_Run_isobxr_presentation.Rmd</code></a></small>
      <div class="hidden name"><code>vgn_03_Run_isobxr_presentation.Rmd</code></div>

    </div>

    
    
<hr>
<p>In this vignette, the user will be introduced to the main function of <a href="https://ttacail.github.io/isobxr/">isobxr</a>: <code>run_isobxr</code>.</p>
<p>Here, we shortly present the principles and general usage of the <code>run_isobxr</code> function.</p>
<p>The user is then invited to follow and run a step-by-step tutorial presenting several typical runs (3 - Run_isobxr: tutorial). <!-- ADD LINK --></p>
<hr>
<div id="system-definitions" class="section level1">
<h1 class="hasAnchor">
<a href="#system-definitions" class="anchor"></a>System definitions</h1>
<p>As a reminder, the systems considered in the <a href="https://ttacail.github.io/isobxr/">isobxr</a> package are described in the cheatsheet below:</p>
<p><img src="02_basics_01_sysdef.png" width="100%"></p>
<hr>
</div>
<div id="how-does-run_isobxr-work" class="section level1">
<h1 class="hasAnchor">
<a href="#how-does-run_isobxr-work" class="anchor"></a>How does <code>run_isobxr</code> work?</h1>
<p>The <code>run_isobxr</code> function is the main function of the <a href="https://ttacail.github.io/isobxr/">isobxr</a> package.</p>
<p>The <code>run_isobxr</code> function is used to perform single runs of stable isotope box models of all types of systems.</p>
<p>The <code>run_isobxr</code> function allows to:</p>
<ol style="list-style-type: decimal">
<li><p>assess the type of modelled system</p></li>
<li><p>render and archive the design of the model and run commands</p></li>
<li><p>automatically run <code>num_slvr</code> or <code>ana_slvr</code> solvers depending on the model design</p></li>
<li><p>provide user with the time evolutions of isotope compositions and masses of X in each box</p></li>
</ol>
<p>The general workflow of the <code>run_isobxr</code> function is summarised in the cheatsheet below:</p>
<p><img src="02_basics_02_runisobxr_wflow.png" width="100%"></p>
<p>To find the detailed description of <code>run_isobxr</code> inputs and outputs, the user can always refer to its documentation:</p>
<div class="sourceCode"><pre class="downlit">
<span class="co"># To see documentation on run_isobxr function, type in console:</span>
<span class="op">?</span><span class="va">run_isobxr</span></pre></div>
<hr>
</div>
<div id="filling-in-0_isobxr_master-xlsx" class="section level1">
<h1 class="hasAnchor">
<a href="#filling-in-0_isobxr_master-xlsx" class="anchor"></a>Filling in <strong>0_ISOBXR_MASTER.xlsx</strong>
</h1>
<p>The <strong>isobxr master file</strong> is the excel document containing all data defining the modelled system.</p>
<p>It provides the <code>run_isobxr</code> function with the <strong>main commands</strong> for a run of stable isotope box model.</p>
<dl>
<dt><strong>Note</strong></dt>
<dd>All the <a href="https://ttacail.github.io/isobxr/">isobxr</a> functions are meant to be run in relation with an <strong>isobxr master file</strong>. As <code>run_isobxr</code> is the fundamental function, called by the other <a href="https://ttacail.github.io/isobxr/">isobxr</a> functions, the <strong>isobxr master file</strong> is also required to run functions performing multiple runs (<code>compose_isobxr</code>, <code>sweep_steady</code>, <code>sweep_dyn</code>).
</dd>
</dl>
<div id="name-and-location" class="section level2">
<h2 class="hasAnchor">
<a href="#name-and-location" class="anchor"></a>Name and location</h2>
<ul>
<li>The <strong>isobxr master file</strong> is an xlsx file</li>
<li>The <strong>isobxr master file</strong> name needs to be exactly as follows: <strong>0_ISOBXR_MASTER.xlsx</strong>
</li>
<li>The <strong>isobxr master file</strong> has to be stored in the working directory (<em>workdir</em>)</li>
</ul>
</div>
<div id="structure-and-format" class="section level2">
<h2 class="hasAnchor">
<a href="#structure-and-format" class="anchor"></a>Structure and format</h2>
<p>The <strong>isobxr master file</strong> contains the 4 following sheet strictly named as follows:</p>
<ol style="list-style-type: decimal">
<li>
<strong>CONSTANTS</strong>: Sheet defining the constants of the isotopic system</li>
<li>
<strong>BOXES</strong>: Sheet defining names and status of all boxes constituting the system</li>
<li>
<strong>FLUXES</strong>: Sheet defining the initial box sizes and massic fluxes of element X between boxes (structured as a column list)</li>
<li>
<strong>COEFFS</strong>: Sheet defining the isotopic fractionation coefficients between all boxes (structured as a column list)</li>
</ol>
<p>The general rules for the filling in of the <strong>isobxr master file</strong> are shown in cheatsheet below:</p>
<p><img src="03_Run_isobxr_01_fill_master.png" width="100%"></p>
<div id="constants" class="section level3">
<h3 class="hasAnchor">
<a href="#constants" class="anchor"></a><strong>CONSTANTS</strong>
</h3>
<p><img src="03_Run_isobxr_02_fill_CONSTs.png" width="100%"></p>
</div>
<div id="boxes-sheet" class="section level3">
<h3 class="hasAnchor">
<a href="#boxes-sheet" class="anchor"></a><strong>BOXES</strong> sheet</h3>
<p><img src="03_Run_isobxr_03_fill_BOXES.png" width="100%"></p>
<dl>
<dt>[INFINITE] column</dt>
<dd><ul>
<li>stores the <em>status of the box</em> depending on the box model design (<strong>open</strong> or <strong>closed</strong>)<br>
</li>
<li>If system is <strong>open</strong>, environment boxes are declared as <strong>INFINITE</strong>.</li>
<li>All <em>finite boxes</em> can be declared with <strong>FINITE</strong> status or other user-defined status (<em>e.g.</em>, <strong>INTERFACE</strong> or <strong>DEAD_END</strong> or <strong>FINITE</strong>)</li>
<li>Status of <em>finite boxes</em> also define color code of system diagrams.</li>
</ul></dd>
<dt>[LAYOUT] columns</dt>
<dd><ul>
<li>
<em>LAYOUT_X</em> and <em>LAYOUT_Y</em> columns correspond to the layout of the <strong>box model diagram</strong><br>
</li>
<li>They define the coordinates of boxes in the diagram in a X,Y space.</li>
</ul></dd>
</dl>
</div>
<div id="fluxes-sheet" class="section level3">
<h3 class="hasAnchor">
<a href="#fluxes-sheet" class="anchor"></a><strong>FLUXES</strong> sheet</h3>
<p><img src="03_Run_isobxr_04_fill_FLUXES.png" width="100%"></p>
<p>The <em>flux lists</em> columns define a set of [fluxes + box sizes] conditions.</p>
<ul>
<li>Flux values (<strong>STATUS</strong> = <strong>FLUX</strong>):
<ul>
<li>Within a given column, users define as many fluxes as desired</li>
<li>Undefined fluxes are set to 0 by <code>run_isobxr</code> (no exchange of element X)</li>
</ul>
</li>
<li>Sizes values (<strong>STATUS</strong> = <strong>SIZE</strong>):
<ul>
<li><strong>Sizes must be defined for all boxes</strong></li>
<li>If a box remains unused (no connected flux), its size can be set to 0</li>
</ul>
</li>
</ul>
<!-- **Negative balance of fluxes** :  --><!-- If too long, the run could lead to the total emptying of the box:  --><!-- * run duration automatically updated to shortest duration box emptying --><!-- * user is advised with a **warning message** in R console --><!-- **Mass and time units** --><!-- :         --><!-- * The **units** of the fluxes (mass/time unit) and sizes (mass unit) need to be homogeneous (same mass unit for both). --><!-- * The **units** of the fluxes (mass unit per time unit) and run duration set in the function (time unit) need to be homogeneous (same time unit for both). -->
</div>
<div id="coeffs-sheet" class="section level3">
<h3 class="hasAnchor">
<a href="#coeffs-sheet" class="anchor"></a><strong>COEFFS</strong> sheet</h3>
<p><img src="03_Run_isobxr_05_fill_COEFFS.png" width="100%"></p>
<!-- All *black text* has to be strictly the same as shown.   -->
<!-- All *blue text* corresponds to litteral names (string of characters) defined by the user.   -->
<!-- All *red text* corresponds to litteral or numerical variables set by the user.   -->
<p>The <strong>COEFFS</strong> sheet takes the values of the isotope fractionation coefficients (<span class="math inline">\(\alpha_{i \to j}\)</span>):</p>
<ul>
<li>Users define as many <em>coefficients lists</em> as desired</li>
<li>Each <em>coefficients lists</em> defines a set of fractionation coefficients</li>
<li>Undefined coefficients are set to 1 by <code>run_isobxr</code> (no isotope fractionation)</li>
</ul>
<hr>
</div>
</div>
</div>
<div id="main-arguments-for-run_isobxr" class="section level1">
<h1 class="hasAnchor">
<a href="#main-arguments-for-run_isobxr" class="anchor"></a>Main arguments for <code>run_isobxr</code>
</h1>
<p>The <code>run_isobxr</code> function takes required and optional arguments that are described in this section.</p>
<p>All arguments definitions of the <code>run_isobxr</code> function are accessible in its documentation called as follows</p>
<div class="sourceCode"><pre class="downlit">
<span class="op">?</span><span class="va">run_isobxr</span></pre></div>
<div id="run_isobxr-required-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#run_isobxr-required-arguments" class="anchor"></a><code>run_isobxr</code> required arguments</h2>
<p>The arguments required to run the <code>run_isobxr</code> function are examplified and described here:</p>
<div class="sourceCode"><pre class="downlit">
<span class="fu"><a href="../reference/run_isobxr.html">run_isobxr</a></span><span class="op">(</span>workdir <span class="op">=</span> <span class="st">"/Users/username/1_isobxr_working_directory/"</span>,
           SERIES_ID <span class="op">=</span> <span class="st">"Name_of_SERIES_ID"</span>, <span class="co"># defining the name of the SERIES of run</span>
           flux_list_name <span class="op">=</span> <span class="st">"Fx3_ABC_open_bal"</span>, <span class="co"># calling the list of fluxes</span>
           coeff_list_name <span class="op">=</span> <span class="st">"a1"</span>, <span class="co">#  calling the list of coefficients</span>
           t_lim <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># running model for 1000 time units</span>
           nb_steps <span class="op">=</span> <span class="fl">100</span>, <span class="co"># running model with 100 steps</span>
           time_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"yr"</span><span class="op">)</span><span class="op">)</span> <span class="co"># plot results in years as time units.</span></pre></div>
<dl>
<dt><strong>workdir</strong></dt>
<dd>Working directory of 0_ISOBXR_MASTER.xlsx master file and where output files will be stored.
</dd>
<dt><strong>SERIES_ID</strong></dt>
<dd>Name of the model series the run belongs to. It determines the folder in which the output files will be stored.
</dd>
<dt><strong>flux_list_name</strong></dt>
<dd>Name of the list of fluxes and initial box sizes to be used for the run, calling (by its header name) a single column of the FLUXES sheet of the 0_ISOBXR_MASTER.xlsx file.
</dd>
<dt><strong>coeff_list_name</strong></dt>
<dd>Name of the list of fractionation coefficients to be used for the run, calling (by its header name) a single column of the COEFFS sheet of the 0_ISOBXR_MASTER.xlsx file.
</dd>
<dt><strong>t_lim</strong></dt>
<dd>Run duration, given in the same time units as the fluxes.
</dd>
<dt><strong>nb_steps</strong></dt>
<dd>Number of calculation steps. It determines the resolution of the run.
</dd>
<dt><strong>time_units</strong></dt>
<dd><ul>
<li>Vector defining the initial time unit (identical to unit used in fluxes), followed by the time unit used for the graphical output</li>
<li>to be selected amongst the following: <em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em>
</li>
<li>e.g., c("d", "yr") to convert days into years</li>
</ul></dd>
</dl>
</div>
<div id="run_isobxr-default-and-optional-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#run_isobxr-default-and-optional-outputs" class="anchor"></a><code>run_isobxr</code> default and optional outputs</h2>
<p>The <code>run_isobxr</code> outputs are stored in the working directory.</p>
<p>The <code>run_isobxr</code> outputs are structured as follows:</p>
<p><img src="03_Run_isobxr_06_outputs_structure.png" width="100%"></p>
<p>In addition to the default outputs, the <code>run_isobxr</code> function allows to:</p>
<ul>
<li>export system diagrams (as pdf, using the <strong>to_DIGEST_DIAGRAMS = TRUE</strong> argument)</li>
<li>export evolution of isotope compositions (as pdf, using the <strong>to_DIGEST_evD_PLOT = TRUE</strong> argument)</li>
<li>export input and output datasets (as csv and xlsx, using the <strong>to_DIGEST_CSV_XLS = TRUE</strong> argument)</li>
</ul>
<p>These arguments are called as follows:</p>
<div class="sourceCode"><pre class="downlit">
<span class="fu"><a href="../reference/run_isobxr.html">run_isobxr</a></span><span class="op">(</span>workdir <span class="op">=</span> <span class="st">"/Users/username/1_isobxr_working_directory/"</span>,
           SERIES_ID <span class="op">=</span> <span class="st">"Name_of_SERIES_ID"</span>, 
           flux_list_name <span class="op">=</span> <span class="st">"Fx3_ABC_open_bal"</span>, 
           coeff_list_name <span class="op">=</span> <span class="st">"a1"</span>, 
           t_lim <span class="op">=</span> <span class="fl">1000</span>, 
           nb_steps <span class="op">=</span> <span class="fl">100</span>, 
           time_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"yr"</span><span class="op">)</span>, 
           to_DIGEST_DIAGRAMS <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># default is TRUE</span>
           to_DIGEST_evD_PLOT <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># default is TRUE</span>
           to_DIGEST_CSV_XLS <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># default is FALSE</span>
           <span class="op">)</span></pre></div>
</div>
<div id="run_isobxr-forcing-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#run_isobxr-forcing-arguments" class="anchor"></a><code>run_isobxr</code> forcing arguments</h2>
<div id="forcing-initial-box-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#forcing-initial-box-sizes" class="anchor"></a>Forcing initial box sizes</h3>
<p>By default, <code>run_isobxr</code> sets the initial box sizes at the values found in the flux list.</p>
<p>It is possible to manually overwrite the initial size of one, several or all boxes for a given run performed by <code>run_isobxr</code>.</p>
<p>It is done by defining a data frame structured as follows.</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_SIZE</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>BOXES_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BOX_1"</span>, <span class="st">"..."</span>, <span class="st">"BOX_i"</span>, <span class="st">"..."</span><span class="op">)</span>,
             SIZE_INIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"updated_size_1"</span>, <span class="st">"..."</span>, <span class="st">"updated_size_i"</span>, <span class="st">"..."</span><span class="op">)</span><span class="op">)</span>

<span class="va">FORCING_SIZE</span>
<span class="co">#&gt;   BOXES_ID      SIZE_INIT</span>
<span class="co">#&gt; 1    BOX_1 updated_size_1</span>
<span class="co">#&gt; 2      ...            ...</span>
<span class="co">#&gt; 3    BOX_i updated_size_i</span>
<span class="co">#&gt; 4      ...            ...</span></pre></div>
<p>For the 3-boxes closed system model (ABC), in order to change the size of box C from 2000 mg of Ca (default as specified in <strong>isobxr master file</strong> for all flux lists of <strong>FLUXES</strong> sheet) to 3000 mg of Ca, the data frame should be structured as follows:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_SIZE</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>BOXES_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span><span class="op">)</span>,
             SIZE_INIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3000</span><span class="op">)</span><span class="op">)</span>

<span class="va">FORCING_SIZE</span>
<span class="co">#&gt;   BOXES_ID SIZE_INIT</span>
<span class="co">#&gt; 1        C      3000</span></pre></div>
</div>
<div id="forcing-initial-delta-values" class="section level3">
<h3 class="hasAnchor">
<a href="#forcing-initial-delta-values" class="anchor"></a>Forcing initial delta values</h3>
<p>By default, the <code>run_isobxr</code> function sets the initial delta values of all boxes at 0 ‰.</p>
<p>It is possible to manually overwrite the initial delta values of one, several or all boxes for a given run performed by <code>run_isobxr</code>.<br>
It is done by defining a data frame structured as follows.</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_DELTA</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>BOXES_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BOX_1"</span>, <span class="st">"..."</span>, <span class="st">"BOX_i"</span>, <span class="st">"..."</span><span class="op">)</span>,
             DELTA_INIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"updated_delta_1"</span>, <span class="st">"..."</span>, <span class="st">"updated_delta_i"</span>, <span class="st">"..."</span><span class="op">)</span><span class="op">)</span>

<span class="va">FORCING_DELTA</span>
<span class="co">#&gt;   BOXES_ID      DELTA_INIT</span>
<span class="co">#&gt; 1    BOX_1 updated_delta_1</span>
<span class="co">#&gt; 2      ...             ...</span>
<span class="co">#&gt; 3    BOX_i updated_delta_i</span>
<span class="co">#&gt; 4      ...             ...</span></pre></div>
<p>For the 3-boxes closed system model (ABC), in order to force initial isotope composition of box A to -1‰, and leave B and C initial values at 0‰, the data frame should be structured as follows:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_DELTA</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>BOXES_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,
             DELTA_INIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">FORCING_DELTA</span>
<span class="co">#&gt;   BOXES_ID DELTA_INIT</span>
<span class="co">#&gt; 1        A         -1</span></pre></div>
</div>
<div id="forcing-isotope-fractionation-coefficients" class="section level3">
<h3 class="hasAnchor">
<a href="#forcing-isotope-fractionation-coefficients" class="anchor"></a>Forcing isotope fractionation coefficients</h3>
<p>By default, the <code>run_isobxr</code> function sets the isotope fractionation coefficients at the values found in the coefficients list specified by user.</p>
<p>It is possible to manually overwrite the fractionation coefficients of one, several or all pairs of boxes for a given run performed by <code>run_isobxr</code>.<br>
It is done by defining a data frame structured as follows.</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_ALPHA</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>FROM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BOX_i"</span>, <span class="st">"..."</span><span class="op">)</span>,
             TO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BOX_j"</span>, <span class="st">"..."</span><span class="op">)</span>,
             ALPHA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"new_coeff_value"</span>, <span class="st">"..."</span><span class="op">)</span>,
             FROM_TO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BOX_i_BOX_j"</span>, <span class="st">"..."</span><span class="op">)</span><span class="op">)</span>

<span class="va">FORCING_ALPHA</span>
<span class="co">#&gt;    FROM    TO           ALPHA     FROM_TO</span>
<span class="co">#&gt; 1 BOX_i BOX_j new_coeff_value BOX_i_BOX_j</span>
<span class="co">#&gt; 2   ...   ...             ...         ...</span></pre></div>
<p>For the 3-boxes closed system model (ABC), in order to force the fractionation coefficient associated to the flux of Ca from box A to B to the value of 1.02, the data frame should be structured as follows:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_ALPHA</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>FROM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,
             TO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span><span class="op">)</span>,
             ALPHA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.02</span><span class="op">)</span>,
             FROM_TO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A_B"</span><span class="op">)</span><span class="op">)</span>

<span class="va">FORCING_ALPHA</span>
<span class="co">#&gt;   FROM TO ALPHA FROM_TO</span>
<span class="co">#&gt; 1    A  B  1.02     A_B</span></pre></div>
</div>
<div id="forcing-fractionation-coefficient-to-a-rayleigh-distillation-model" class="section level3">
<h3 class="hasAnchor">
<a href="#forcing-fractionation-coefficient-to-a-rayleigh-distillation-model" class="anchor"></a>Forcing fractionation coefficient to a Rayleigh distillation model</h3>
<p>It is possible to overwrite isotope fractionation coefficients by defining their values as the result of Rayleigh type isotope distillation in the context of a fractional exchange at an interface.</p>
<p>We consider here the case of the loss of element X from a box A to a box C through an interface box B, all possibly part of a bigger box model system.</p>
<p>We suppose that the apparent fractionation coefficient <span class="math inline">\(\alpha_{A \to C}\)</span> associated to this flux <span class="math inline">\(F_{A \to C}\)</span> results from a Rayleigh type distillation occuring during the fractional exchange of element X at the interface box B.</p>
<p><img src="03_Run_isobxr_07_Rayleigh.png" width="100%"></p>
<p>In this situation, the box A exchanges element X with box B (and possibly other boxes).</p>
<p>This is a fractional exchange, <em>i.e.</em> during this exchange, box A sends more of element X to box B than B sends back (<span class="math inline">\(F_{A \to B} &gt; F_{B \to A}\)</span>).</p>
<p>As we consider box B to be balanced, it loses the difference to box C: <span class="math inline">\(F_{B \to C} = F_{A \to B} - F_{B \to A}\)</span>.</p>
<p>As a result, box A loses a total of <span class="math inline">\(F_{B \to C}\)</span> of element X per time unit.</p>
<p>We suppose here that the <span class="math inline">\(F_{A \to B}\)</span> that feeds box B is associated to no isotope fractionation.</p>
<p>On the other hand, we suppose that the <span class="math inline">\(F_{B \to A}\)</span> flux corresponding to the fractional loss of element X from interface box B, and returning to box A, is associated to an <em>equilibrium</em> or <em>incremental</em> isotope fractionation (<span class="math inline">\(\alpha^0 _{B \to A}\)</span>).</p>
<p>The Rayleigh distillation model of isotopes thus predicts the following:</p>
<p><span class="math display">\[R_{C} = R_{C, t_0} \dfrac{F_{B \to C}}{F_{A \to B}}^{\alpha^0 _{B \to A} - 1}  \]</span></p>
<p>The <span class="math inline">\(R_{C, t_0}\)</span> corresponds to the isotope ratio of the element X in box B before any exchange with box A occurs. It is thus equivalent to <span class="math inline">\(R_{A}\)</span> since the box B only input is <em>via</em> the <span class="math inline">\(F_{A \to B}\)</span> flux.</p>
<p>We thus can write the following definition of <span class="math inline">\(\alpha_{B \to C}\)</span> (equivalent here to <span class="math inline">\(\alpha_{A \to C}\)</span>):</p>
<p><span class="math inline">\(\alpha_{B \to C} = \dfrac{R_{C}}{R_{A}} = \dfrac{F_{B \to C}}{F_{A \to B}}^{\alpha^0 _{B \to A} - 1}\)</span></p>
<p>The <code>run_isobxr</code> function here takes as an optional input the data frame structured as follows:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">FORCING_RAYLEIGH</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>XFROM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span><span class="op">)</span>, <span class="co"># Define the B&gt;C flux at numerator</span>
             XTO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span><span class="op">)</span>,
             YFROM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>, <span class="co"># Define the A&gt;B flux at denominator</span>
             YTO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span><span class="op">)</span>,
             AFROM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span><span class="op">)</span>, <span class="co"># Define the resulting fractionation coefficient</span>
             ATO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span><span class="op">)</span>,
             ALPHA_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a0"</span><span class="op">)</span> <span class="co"># Define the value of incremental B&gt;A coefficient</span>
  <span class="op">)</span> 

<span class="va">FORCING_RAYLEIGH</span>
<span class="co">#&gt;   XFROM XTO YFROM YTO AFROM ATO ALPHA_0</span>
<span class="co">#&gt; 1     B   C     A   B     B   C      a0</span></pre></div>
<p>The <code>run_isobxr</code> function will in this case overwrite the value of <span class="math inline">\(\alpha_{B \to C}\)</span> set in <strong>isobxr master file</strong> or using the FORCING_ALPHA parameter.</p>
<p>Indeed, if the user forced a new value for <span class="math inline">\(\alpha_{B \to C}\)</span> using the FORCING_ALPHA parameter, the <code>run_isobxr</code> function will prioritize the FORCING_RAYLEIGH parameter.</p>
<p>It is possible to define several Rayleigh distillation apparent fractionation coefficients in a given model.<br>
This is done by adding rows to this data frame.</p>
<!-- # Prepare the demo -->
<!-- 1. If not done yet, install the [isobxr](https://ttacail.github.io/isobxr/) package ([installation instructions](https://ttacail.github.io/isobxr/articles/isobxr_vignette.html#installation-1)). -->
<!-- 2. Load isobxr in R: -->
<!-- ```{r eval=FALSE} -->
<!-- library(isobxr) -->
<!-- ``` -->
<!-- 3. [Download the ABC tutorial zip file](https://ttacail.github.io/source/demos/1_ABC_tutorial.zip). -->
<!-- Note -->
<!-- :    The templates of all master files (.xlsx format) described in this vignette are available for  -->
<!--      [download here](https://ttacail.github.io/source/demos/0_excel_templates.zip). -->
<!-- 4. Unzip the ABC tutorial file and place it in the working directory of your choice. It is strongly advised to avoid using a working directory linked to an online backup server (such as OneDrive) since it could cause some issues with adressing of output files. If done so, users are then advised to turn the backup server software offline during the use of isobxr functions. -->
<!-- 5. Take note of the path to this folder, for instance: -->
<!-- ```{r eval=FALSE} -->
<!-- workdir <- "/Users/username/Documents/isobxr/demos/1_ABC_tutorial/" -->
<!-- ``` -->
<!-- Everything is now ready to run box models with [isobxr](https://ttacail.github.io/isobxr/). -->
<!-- ---- -->
<!-- # Example #1: Balanced 3-boxes closed system model -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./EXAMPLE_1_ABC_clo_bal.png') -->
<!-- ``` -->
<!-- We consider here the case a balanced closed system of 3 finite boxes (flux list *Fx1_ABC_closed_bal*).   -->
<!-- For this run we use the *a1* fractionation coefficients list: we only force a -1‰ fractionation during transport from box C to A. -->
<!-- We will run this model for total time of 2500 days with a resolution of 1 calculation every 10 days,  -->
<!-- thus corresponding to 250 steps.   -->
<!-- ```{r eval=FALSE} -->
<!-- run_isobxr(workdir = "/Users/username/Documents/isobxr/demos/1_ABC_tutorial/", # isobxr master file work. dir. -->
<!--            SERIES_ID = "ABC_closed_balanced", # series ID of the set of runs -->
<!--            flux_list_name = "Fx1_ABC_closed_bal", # which flux list from FLUXES sheet -->
<!--            coeff_list_name = "a1", # which coefficients list from COEFFS sheet -->
<!--            t_lim = 2500, # how long do I want to run -->
<!--            nb_steps = 250, # how many steps over this run duration -->
<!--            time_units = c("d", "yr"), # run time units (days), plot time units (years) -->
<!--            to_DIGEST_evD_PLOT = TRUE, -->
<!--            to_DIGEST_CSV_XLS = TRUE, -->
<!--            to_DIGEST_DIAGRAMS = TRUE) # export plot as pdf -->
<!-- ``` -->
<!-- The first default outputs of the run are the messages sent by the function on the R console (all of these pieces of information being besides stored in the LOG file). -->
<!-- The `run_isobxr` function therefore choses to run the analytical solver (`ana_slvr`). -->
<!-- In the case of this run we can see the following messages: -->
<!-- ```{r echo=FALSE} -->
<!-- "< All boxes are FINITE >" -->
<!-- "< Running ana_slvr (BALANCED FINITE BOXES) > " -->
<!-- ``` -->
<!-- This is expected because: -->
<!-- 1. no INFINITE box has been declared as connected to the A, B and C boxes -->
<!-- 2. all inward and outward fluxes for each box are expected to be balanced -->
<!-- The associated pre-run outputs (optional) are the model diagrams of fluxes (left) -->
<!-- and of fractionation coefficients (right, expressed as amplitude of isotope fractionation, in ‰).  -->
<!-- The first default outputs of the run are the messages sent by the function on the R console (all of these pieces of information being besides stored in the LOG file). -->
<!-- The `run_isobxr` function therefore choses to run the analytical solver (`ana_slvr`). -->
<!-- In the case of this run we can see the following messages: -->
<!-- ```{r echo=FALSE} -->
<!-- "< All boxes are FINITE >" -->
<!-- "< Running ana_slvr (BALANCED FINITE BOXES) > " -->
<!-- ``` -->
<!-- This is expected because: -->
<!-- 1. no INFINITE box has been declared as connected to the A, B and C boxes -->
<!-- 2. all inward and outward fluxes for each box are expected to be balanced -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./14_outputs_structure.png') -->
<!-- ``` -->
<!-- The associated pre-run outputs (optional) are the model diagrams of fluxes (left) and of fractionation coefficients (right, expressed as amplitude of isotope fractionation, in ‰).  -->
<!-- ```{r echo=FALSE, out.width='47%'} -->
<!-- knitr::include_graphics('./15_ABC_balanced_closed_0001_DIAGf_Fx1_ABC_bal.png') -->
<!-- knitr::include_graphics('./14_ABC_balanced_closed_0001_DIAGa_a1.png') -->
<!-- ``` -->
<!-- Finally, the post-run output includes the evolution of $\delta$ values over the run duration, shown in years for this run. -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./16_ABC_balanced_closed_0001_plot_evD.png') -->
<!-- ``` -->
<!-- Note that the run resolution can be seen by the discrete behavior of the evolution of $\delta$ values on the left handside of the logarithmic time scale.  -->
<!-- This display effect would be smoothed out by a higher run resolution (nb_steps = 2500 or 25000 for instance). -->
<!-- # Systems and *isobxr master file* -->
<!-- We consider the demonstration *isobxr master file* (0_ISOBXR_MASTER.xlsx) stored in the working directory. -->
<!-- In this demonstration example, the *isobxr master file* describes a fiction model,  -->
<!-- designed for the calcium $^{44}Ca/^{42}Ca$ isotope ratios.  -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./EXAMPLE_1_ABC_clo_bal.png') -->
<!-- ``` -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./EXAMPLE_2_ABC_clo_unbal.png') -->
<!-- ``` -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./EXAMPLE_3_ABC_open_bal.png') -->
<!-- ``` -->
<!-- The **BOXES** sheet describes 3 finite boxes (A, B, C).  -->
<!-- The layout of the boxes in the diagram rendering aims at placing the finite boxes on the four corners of 10x10 units square, and the two infinite boxes on the higher end of the layout (y = 15), with SOURCE on the far left and SINK on the far right. -->
<!-- ```{r echo=FALSE, out.width='50%'} -->
<!-- knitr::include_graphics('./40_ABCD_BOXES.png') -->
<!-- ``` -->
<!-- We assume that fluxes are expressed in mg of Ca per day, sizes in mg of Ca and run time units will be days.   -->
<!-- The **FLUXES** sheet describes 5 flux lists   -->
<!-- 1. *Fx1_ABC_bal* describes a balanced closed system composed of 3 finite boxes A, B and C.    -->
<!-- 1. *Fx2_ABC_unbal* describes an unbalanced closed system composed of 3 finite boxes A, B and C.   -->
<!-- 1. *Fx3_ABC_unbal* describes an unbalanced closed system composed of 3 finite boxes A, B and C.    -->
<!-- 1. *Fx4_ABCD_bal* describes a balanced closed system composed of 4 finite boxes A, B, C and D.      -->
<!-- 1. *Fx5_ABCD_unbal*  describes an unbalanced closed system composed of 4 finite boxes A, B, C and D.   -->
<!-- 1. *Fx6_ABC_open_bal*  describes a balanced open system composed of 4 finite boxes A, B, C and D and two infinite boxes SOURCE and SINK. -->
<!-- 1. *Fx7_ABC_open_unbal*  describes an unbalanced open system composed of 4 finite boxes A, B, C and D and two infinite boxes SOURCE and SINK. -->
<!-- Sizes of all finite boxes are here set at 2000 mg, infinite boxes are set a 1e15 mg.   -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./41_ABCD_FLUXES.png') -->
<!-- ``` -->
<!-- The **COEFFS** sheet describes 5 lists of fractionation coefficients:   -->
<!-- * *a0* describes no isotope fractionation (all $\alpha_{i \to j}$ being equal to one)   -->
<!-- * *a1* describes a system with 1 fractionation coefficient being different from 1:    -->
<!--     $\alpha_{A \to B} = 0.999$   -->
<!-- * *a2* describes a system with 2 fractionation coefficients being different from 1:   -->
<!--     $\alpha_{A \to B} = 0.999$, $\alpha_{B \to A} = 1.001$   -->
<!-- * *a3* describes a system with 3 fractionation coefficients being different from 1:   -->
<!--     $\alpha_{A \to B} = 0.999$, $\alpha_{B \to A} = 1.001$, $\alpha_{C \to A} = 0.9997$   -->
<!-- * *a4* describes a system with 1 fractionation coefficient being different from 1:   -->
<!--     $\alpha_{C \to D} = 0.99$   -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./13_ABCD_COEFFS.png') -->
<!-- ``` -->
<!-- ---- -->
<!-- # Run single box models -->
<!-- ## Balanced 3-boxes closed system model -->
<!-- We consider here the case a balanced closed system of 3 finite boxes (flux list *Fx1_ABC_bal*).   -->
<!-- For this run we use the *a1* fractionation coefficients list.   -->
<!-- We will run this model for total time of 2500 days with a resolution of 1 calculation every 10 days (250 steps).   -->
<!-- ```{r eval=FALSE} -->
<!-- run_isobxr(workdir = "/Users/username/Documents/isobxr/demos/1_ABC_tutorial/", # isobxr master file work. dir. -->
<!--            SERIES_ID = "ABC_closed_balanced", # series ID of the set of runs -->
<!--            flux_list_name = "Fx1_ABC_closed_bal", # which flux list from FLUXES sheet -->
<!--            coeff_list_name = "a1", # which coefficients list from COEFFS sheet -->
<!--            t_lim = 2500, # how long do I want to run -->
<!--            nb_steps = 250, # how many steps over this run duration -->
<!--            time_units = c("d", "yr"), # run time units (days), plot time units (years) -->
<!--            to_DIGEST_evD_PLOT = TRUE, -->
<!--            to_DIGEST_CSV_XLS = TRUE, -->
<!--            to_DIGEST_DIAGRAMS = TRUE) # export plot as pdf -->
<!-- ``` -->
<!-- The first default outputs of the run are the messages sent by the function on the R console (all of these pieces of information being besides stored in the LOG file). -->
<!-- The `run_isobxr` function therefore choses to run the analytical solver (`ana_slvr`). -->
<!-- In the case of this run we can see the following messages: -->
<!-- ```{r echo=FALSE} -->
<!-- "< All boxes are FINITE >" -->
<!-- "< Running ana_slvr (BALANCED FINITE BOXES) > " -->
<!-- ``` -->
<!-- This is expected because: -->
<!-- 1. no INFINITE box has been declared as connected to the A, B and C boxes -->
<!-- 2. all inward and outward fluxes for each box are expected to be balanced -->
<!-- The associated pre-run outputs (optional) are the model diagrams of fluxes (left) and of fractionation coefficients (right, expressed as amplitude of isotope fractionation, in ‰).  -->
<!-- ```{r echo=FALSE, out.width='47%'} -->
<!-- knitr::include_graphics('./15_ABC_balanced_closed_0001_DIAGf_Fx1_ABC_bal.png') -->
<!-- knitr::include_graphics('./14_ABC_balanced_closed_0001_DIAGa_a1.png') -->
<!-- ``` -->
<!-- Finally, the post-run output includes the evolution of $\delta$ values over the run duration, shown in years for this run. -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./16_ABC_balanced_closed_0001_plot_evD.png') -->
<!-- ``` -->
<!-- Note that the run resolution can be seen by the discrete behavior of the evolution of $\delta$ values on the left handside of the logarithmic time scale.  -->
<!-- This display effect would be smoothed out by a higher run resolution (nb_steps = 2500 or 25000 for instance). -->
<!-- ## Unbalanced 3-boxes closed system model -->
<!-- We consider here the case of an unbalanced closed system of 3 finite boxes (flux list *Fx2_ABC_unbal*).   -->
<!-- For this run we use the *a1* fractionation coefficients list.   -->
<!-- We will run this model for a total time of 2500 days with a resolution of 1 calculation every 10 days (250 steps).   -->
<!-- ```{r eval=FALSE} -->
<!-- run_isobxr(workdir = "/Users/username/Documents/isobxr/demos/1_ABC_tutorial/", # isobxr master file work. dir. -->
<!--            SERIES_ID = "ABC_closed_unbalanced", # series ID of the set of runs -->
<!--            flux_list_name = "Fx2_ABC_closed_unbal", # which flux list from FLUXES sheet -->
<!--            coeff_list_name = "a1", # which coefficients list from COEFFS sheet -->
<!--            t_lim = 2500, # how long do I want to run -->
<!--            nb_steps = 250, # how many steps over this run duration -->
<!--            time_units = c("d", "yr"), # run time units (days), plot time units (years) -->
<!--            to_DIGEST_evD_PLOT = TRUE, -->
<!--            to_DIGEST_CSV_XLS = TRUE, -->
<!--            to_DIGEST_DIAGRAMS = TRUE) # export plot as pdf -->
<!-- ``` -->
<!-- The first default outputs of the run are the messages sent by the function on the R console (all of these pieces of information being besides stored in the LOG file). -->
<!-- In the case of this run we can see the following messages: -->
<!-- ```{r echo=FALSE} -->
<!-- "< All boxes are FINITE >" -->
<!-- "< A IN-OUT BALANCE is pos >"  -->
<!-- "< C IN-OUT BALANCE is neg (max run: 2000 t units) >"  -->
<!-- "< Running num_slvr (UNBALANCED FINITE BOXES) >"  -->
<!-- "*** UPDATED TOTAL RUN TIME *** < Total run time has been changed from 2500 to 2000 (limiting box: C) > " -->
<!-- ``` -->
<!-- The first message is expected since no INFINITE box has been declared as connected to the finite boxes defining the closed system. -->
<!-- The second and third lines point out the fact that boxes A and C are out of balance: A accumulates calcium while C loses calcium.  -->
<!-- The function also tells us that it will take in total 2000 days for the box C to be totally emptied. This is expected since C has a size of 2000 mg and, as can be seen on the flux diagram below, C loses 1 mg of Ca per day. -->
<!-- The `run_isobxr` function therefore choses to run the numerical solver (`num_slvr`). -->
<!-- Finally, the `run_isobxr` function warns the user: it automatically updated the total run time, changing it from 2500 days to 2000 days because the box C would have lost all of its calcium by 2000 days. -->
<!-- This is due to the fact that the user defined run duration was too long and would lead to the total emptying of box C. -->
<!-- The associated pre-run outputs (optional) are the model diagrams of fluxes (left) and of fractionation coefficients (right, expressed as amplitude of isotope fractionation, in ‰).  -->
<!-- ```{r echo=FALSE, out.width='47%'} -->
<!-- knitr::include_graphics('./17_ABC_unbalanced_closed_0001_DIAGf_Fx2_ABC_unbal.png') -->
<!-- knitr::include_graphics('./18_ABC_unbalanced_closed_0001_DIAGa_a1.png') -->
<!-- ``` -->
<!-- Finally, the post-run output includes the evolution of $\delta$ values over the run duration, shown in years for this run. -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./19_ABC_unbalanced_closed_0001_plot_evD.png') -->
<!-- ``` -->
<!-- Note that in this example, the slight imbalance does not affect the overall bevaviour of the system at time scale when compared to the balanced system. -->
<!-- ## Dealing with an open system -->
<!-- The user should define a source box and a sink box and declare them in the **BOXES** sheet as INFINITE.  -->
<!-- We give below an example of a run of for an open system. -->
<!-- ```{r echo=FALSE, out.width='50%'} -->
<!-- knitr::include_graphics('./21a_ABC_balanced_open_BOXES.png') -->
<!-- ``` -->
<!-- These boxes should have infinite sizes defined in relation to the system scale  -->
<!-- (important for runs with unbalanced finite boxes, which will use the numerical solver).  -->
<!-- In this example, both source and sink box sizes were set at $10^{15}$. -->
<!-- The source box should only be used with outward fluxes to the open system and should not receive any flux from it. -->
<!-- The sink box should only be used with inward fluxes from the open system and should not send any flux to it. -->
<!-- The function call would be the following for a run of 25000 days, with one calculation every 10 days (nb_steps = 2500).   -->
<!-- We use the *Fx6_ABC_open_bal* flux list and the *a1* coefficient list. -->
<!-- ```{r eval=FALSE} -->
<!-- run_isobxr(workdir = "/Users/username/Documents/isobxr/demos/1_ABC_tutorial/", # isobxr master file work. dir. -->
<!--            SERIES_ID = "ABC_open_balanced", # series ID of the set of runs -->
<!--            flux_list_name = "Fx3_ABC_open_bal", # which flux list from FLUXES sheet -->
<!--            coeff_list_name = "a1", # which coefficients list from COEFFS sheet -->
<!--            t_lim = 25000, # how long do I want to run -->
<!--            nb_steps = 2500, # how many steps over this run duration -->
<!--            time_units = c("d", "yr"), # run time units (days), plot time units (years) -->
<!--            to_DIGEST_evD_PLOT = TRUE, -->
<!--            to_DIGEST_CSV_XLS = TRUE, -->
<!--            to_DIGEST_DIAGRAMS = TRUE) # export plot as pdf -->
<!-- ``` -->
<!-- We obtain the following diagrams, where the infinite boxes display a different color.  -->
<!-- ```{r echo=FALSE, out.width='47%'} -->
<!-- knitr::include_graphics('./22_ABC_balanced_open_0001_DIAGf_Fx6_ABC_open_bal.png') -->
<!-- knitr::include_graphics('./21_ABC_balanced_open_0001_DIAGa_a1.png') -->
<!-- ``` -->
<!-- And we finally obtain the following plot of the evolution of $\delta$ values in all finite boxes over time,  -->
<!-- where we observe the relaxation of the system to it's steady state.  -->
<!-- ```{r echo=FALSE, out.width='100%'} -->
<!-- knitr::include_graphics('./23_ABC_balanced_open_0001_plot_evD.png') -->
<!-- ``` -->
<!-- Note that both infinite boxes are hidden from this graphic representation but the isotope compositions of all boxes - including source and sink - are stored in the output data files.   -->
<!-- While the sink (or waste) box is not informative as such, -->
<!-- the source could have varying/non-zero initial $\delta$ values, -->
<!-- depending on the run parameters,  -->
<!-- used to force the open system. It will be notably of importance for the use of the `compose_isobxr` function, described thereafter. -->
<!-- ---- -->
<!-- # Play time -->
<!-- The user is invited to explore the use of the **run_isobxr** function by running box models with various settings and input values, from the function arguments but also by adding new entries to the **input master file**.  -->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Theo Tacail.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
